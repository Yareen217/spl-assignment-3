[1mdiff --git a/client/src/StompProtocol.cpp b/client/src/StompProtocol.cpp[m
[1mindex 3534ed3..5cb01b4 100644[m
[1m--- a/client/src/StompProtocol.cpp[m
[1m+++ b/client/src/StompProtocol.cpp[m
[36m@@ -3,16 +3,16 @@[m
 #include <sstream>[m
 #include <algorithm>[m
 [m
[31m-// command line[m
[32m+[m[32m//helper method[m
 static std::string getCommand(const std::string& frame) {[m
[31m-    size_t pos = frame.find('\n');[m
[31m-    std::string cmd = (pos != std::string::npos) ? frame.substr(0,pos) : frame;[m
[32m+[m[32m    size_t newLineIndx = frame.find('\n');[m
[32m+[m[32m    std::string cmd = (newLineIndx != std::string::npos) ? frame.substr(0, newLineIndx) : frame;[m
     if(!cmd.empty() && cmd.back() == '\r') {[m
         cmd.pop_back();[m
     }[m
     return cmd;[m
 }[m
[31m-//helper method: remove spaces/\r[m
[32m+[m[32m//helper method[m
 static void trim (std::string& str) {[m
     while(!str.empty() && (str.back() == ' ' || str.back() == '\t' || str.back() == '\r')) {[m
         str.pop_back();[m
[36m@@ -26,11 +26,11 @@[m [mstatic void trim (std::string& str) {[m
     }[m
 }[m
 //helper method[m
[31m-    static void addStats(std::string& out, const std::string& title, [m
[32m+[m[32m    static void appendUpdates(std::string& out, const std::string& title,[m[41m [m
                             const std::map<std::string, std::string>& updates) {[m
         out += title + ":\n";[m
         for (const auto& p : updates) {[m
[31m-            out += "    " + p.first + ": " + p.second + "\n";[m
[32m+[m[32m            out += "   " + p.first + ": " + p.second + "\n";[m
         }[m
     }[m
 [m
[36m@@ -42,7 +42,7 @@[m [mStompProtocol::StompProtocol(ConnectionHandler& CH) : connectionHandler(CH),[m
 StompProtocol::~StompProtocol() {[m
     stop();[m
 }[m
[31m-// ----- lifecycle ------[m
[32m+[m[32m// =============================== lifecycle ===============================[m
 [m
 bool StompProtocol::isRunning() const {[m
     return running.load();[m
[36m@@ -60,7 +60,7 @@[m [mvoid StompProtocol::stop() {[m
     if(socketThread.joinable()) socketThread.join();[m
 }[m
 [m
[31m-// ----- socket thread -----[m
[32m+[m[32m// =============================== socket thread ===============================[m
 [m
 void StompProtocol::processSocket() {[m
     while (running) {[m
[36m@@ -88,7 +88,6 @@[m [mvoid StompProtocol::handleServerFrame(const std::string& frame) {[m
         return;[m
     }[m
     else if(cmd == "ERROR"){[m
[31m-        if(!loggedIn.load()){[m
         std::string msg = "ERROR";[m
         if(frame.find("wrong password") != std::string::npos || frame.find("Wrong password") != std::string::npos)[m
             msg = "Wrong password";[m
[36m@@ -101,19 +100,11 @@[m [mvoid StompProtocol::handleServerFrame(const std::string& frame) {[m
             loginMessage = msg;[m
             gotLoginResponse = true;[m
     }[m
[31m-        cVariable.notify_all();      [m
[32m+[m[32m        cVariable.notify_all();[m
         running = false;[m
         connectionHandler.close();[m
         return;[m
 }[m
[31m-        std::cout << frame << std::endl;[m
[31m-        running = false;[m
[31m-        connectionHandler.close();[m
[31m-        cVariable.notify_all(); [m
[31m-        return;[m
[31m-[m
[31m-}[m
[31m-[m
     if(cmd == "RECEIPT"){[m
     std::string receiptIdtxt = getheaderValue(frame, "receipt-id");[m
     if(!receiptIdtxt.empty()){[m
[36m@@ -122,7 +113,7 @@[m [mvoid StompProtocol::handleServerFrame(const std::string& frame) {[m
             std::lock_guard<std::mutex> lock(mutex);[m
             receiptDone.insert(recId);[m
         }[m
[31m-        cVariable.notify_all();     // wake thread waiting in waitForReceipt()[m
[32m+[m[32m        cVariable.notify_one();[m
     }   [m
     return;[m
 }[m
[36m@@ -132,7 +123,7 @@[m [mvoid StompProtocol::handleServerFrame(const std::string& frame) {[m
     }[m
  }[m
 [m
[31m- // ------ keyboard input processing -----[m
[32m+[m[32m // =============================== keyboard input processing ===============================[m
 [m
 void StompProtocol::processkeyboardInput(const std::string& line) {[m
     std::istringstream iss(line);[m
[36m@@ -179,7 +170,7 @@[m [mvoid StompProtocol::processkeyboardInput(const std::string& line) {[m
  }[m
 }[m
 [m
[31m-// ------ command handlers ------[m
[32m+[m[32m// =============================== command handlers ===============================[m
 [m
 void StompProtocol::handleLogin(const std::string& hostPort,[m
                                 const std::string& username,[m
[36m@@ -196,7 +187,6 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
     }[m
 [m
     {[m
[31m-        //wait until socket thread receives connected or error [m
         std::lock_guard<std::mutex> lk(mutex);[m
         gotLoginResponse = false;[m
         loginMessage = "Login failed";[m
[36m@@ -221,7 +211,9 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         return gotLoginResponse || !running.load();[m
     });[m
 [m
[31m-   if(gotLoginResponse) std::cout << loginMessage << std::endl;[m
[32m+[m[32m    if (!running.load()) return;[m
[32m+[m
[32m+[m[32m    std::cout << loginMessage << std::endl;[m
 [m
     if (loginMessage == "Login successful") {[m
         loggedIn.store(true);[m
[36m@@ -259,9 +251,6 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
             std::cout << "Disconnected. Exiting...\n";[m
             running = false;[m
             connectionHandler.close();[m
[31m-            //remove from map [m
[31m-            std::lock_guard<std::mutex> lock(mutex);[m
[31m-            channelToSubId.erase(channel);[m
             return;[m
         }[m
         waitForReceipt(recId);[m
[36m@@ -333,11 +322,11 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
             body += "team a: " + event.get_team_a_name() + "\n";[m
             body += "team b: " + event.get_team_b_name() + "\n";[m
             body += "event name: " + event.get_name() + "\n";[m
[31m-            body += "time: " + std::to_string(event.get_time()) + "\n";[m
[32m+[m[32m            body += "time:" + std::to_string(event.get_time()) + "\n";[m
 [m
[31m-            addStats(body, "general game updates", event.get_game_updates());[m
[31m-            addStats(body, "team a updates", event.get_team_a_updates());[m
[31m-            addStats(body, "team b updates", event.get_team_b_updates());[m
[32m+[m[32m            appendUpdates(body, "general game updates", event.get_game_updates());[m
[32m+[m[32m            appendUpdates(body, "team a updates", event.get_team_a_updates());[m
[32m+[m[32m            appendUpdates(body, "team b updates", event.get_team_b_updates());[m
 [m
             body += "description:\n";[m
             body += event.get_discription() + "\n";[m
[36m@@ -345,6 +334,7 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
 [m
             std::string frame = "SEND\n"[m
             "destination:/" + gameName + "\n"[m
[32m+[m[32m            "file-name:" + filepath + "\n"[m
             "\n" +[m
             body;[m
 [m
[36m@@ -366,7 +356,6 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         }[m
      UserGameInfo copy;[m
      {[m
[31m-        //lock while copying to avoid blocking socket thread for long time[m
         std::lock_guard<std::mutex> lock(mutex);[m
         auto it = game_updates.find(gameName);[m
         if(it == game_updates.end()) {[m
[36m@@ -381,7 +370,6 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         copy = userIt->second;[m
     }[m
         std::vector<storedEvent> eventsCopy = copy.events;[m
[31m-        // sorting by half before time because timestamps can go backwardsafter halftime[m
         std::sort(eventsCopy.begin(), eventsCopy.end(),[m
                   [](const storedEvent& a, const storedEvent& b) {[m
                       if(a.secondHalf != b.secondHalf) {[m
[36m@@ -397,8 +385,7 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         out << copy.teamA << " vs " << copy.teamB << "\n";[m
         out << "Game stats:\n";[m
         out << "General stats:\n";[m
[31m-          [m
[31m-        //stats are printed lexicograpghically[m
[32m+[m
         for(const auto& p : copy.generalUpdates) {[m
             out << p.first << ": " << p.second << "\n";[m
         }[m
[36m@@ -415,6 +402,7 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         for(const auto& event : eventsCopy) {[m
             out << event.time << " - " << event.name << ":\n";[m
             out << event.description << "\n";[m
[32m+[m[32m            out << "\n";[m
         }[m
     }[m
 [m
[36m@@ -448,7 +436,7 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
     std::cout << "Logged out" << std::endl;[m
 }[m
 [m
[31m-// ----- message parsing -----[m
[32m+[m[32m// =============================== message parsing ===============================[m
 [m
     void StompProtocol::handleMessage(const std::string& frame) {[m
         std ::string dest = getheaderValue(frame, "destination");[m
[36m@@ -486,7 +474,6 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         for(const auto& p : event.get_team_b_updates()) {[m
             info.teamBUpdates[p.first] = p.second;[m
         }[m
[31m-        // half time handling[m
         bool isBeforeHalf = info.beforeHalftime;[m
        auto it = event.get_game_updates().find("before halftime");[m
        if(it != event.get_game_updates().end()) {[m
[36m@@ -510,7 +497,7 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
     std::string StompProtocol::getBody(const std::string& frame) {[m
         size_t pos = frame.find("\n\n");[m
         if (pos != std::string::npos) {[m
[31m-            return frame.substr(pos + 2); // to skip the two newlines[m
[32m+[m[32m            return frame.substr(pos + 2); // +2 to skip the two newlines[m
         }[m
         return "";[m
     }[m
[36m@@ -596,7 +583,7 @@[m [mvoid StompProtocol::handleLogin(const std::string& hostPort,[m
         return true;[m
               }[m
 [m
[31m-            // ------ helper methods ------[m
[32m+[m[32m            // =============================== helper methods ===============================[m
     [m
     std::string StompProtocol::getheaderValue(const std::string& frame, const std::string& header) {[m
        std::istringstream in(frame);[m
